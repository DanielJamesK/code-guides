<% if (current_user.has_role?(:admin)) %>
  <h1>Listings</h1>
  <table class="table">
    <thead>
      <tr>
        <th>Tutor name</th>
        <th>Tutor email</th>
        <th>Title</th>
        <th>Description</th>
        <th>Price</th>
        <th>Image</th>
        <th>User</th>
        <th>Programming language</th>
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% @listings.each do |listing| %>
        <tr>
          <td><%= sanitize listing.tutor_name %></td>
          <td><%= sanitize listing.tutor_email %></td>
          <td><%= sanitize listing.title %></td>
          <td><%= sanitize listing.description %></td>
          <td><%= listing.price %></td>
          <td><% if listing.picture.attached? %>
            <%= cl_image_tag(listing.picture.key, crop: :scale, cloud_name: "dvlberf5o", width: 50) %>
          <% else %>
            <%= image_tag("defaultimage2.png", width: 50)%>
          <% end %></td>
          <td><%= listing.user_id %></td>
          <td><%= listing.programming_language_id %></td>
          <td><%= link_to 'Show', listing, class: "btn btn-secondary" %></td>
          <td><%= link_to 'Edit', edit_listing_path(listing), class: "btn btn-secondary" %></td>
          <td><%= link_to 'Destroy', listing, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-secondary" %></td>
        </tr>
      <% end %>
    </tbody>
    <tbody>
  </table>
  <br>
<% end %>
<h1>Personal Listings</h1>

<table class="table">
  <thead>
    <tr>
      <th>Tutor name</th>
      <th>Tutor email</th>
      <th>Title</th>
      <th>Description</th>
      <th>Price</th>
      <th>Image</th>
      <th>User</th>
      <th>Programming language</th>
      <th colspan="3"></th>
    </tr>
  </thead>
    <% @personal_listings.each do |listing| %>
      <tr>
        <td><%= sanitize listing.tutor_name %></td>
        <td><%= sanitize listing.tutor_email %></td>
        <td><%= sanitize listing.title %></td>
        <td><%= sanitize listing.description %></td>
        <td><%= listing.price %></td>
        <td><% if listing.picture.attached? %>
          <%= cl_image_tag(listing.picture.key, crop: :scale, cloud_name: "dvlberf5o", width: 50) %>
        <% else %>
          <%= image_tag("defaultimage2.png", width: 50)%>
        <% end %></td>
        <td><%= listing.user_id %></td>
        <td><%= listing.programming_language_id %></td>
        <td><%= link_to 'Show', listing, class: "btn btn-secondary" %></td>
        <td><%= link_to 'Edit', edit_listing_path(listing), class: "btn btn-secondary" %></td>
        <td><%= link_to 'Destroy', listing, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-secondary" %></td>
      </tr>
    <% end %>
  </tbody>
</table>
<br>

<%= link_to 'New Listing', new_listing_path, class: "btn btn-primary btn-margin" %>
